<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Workflow Deployment Guide • emburden</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Workflow Deployment Guide"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">emburden</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="articles/methodology.html">Methodology</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="articles/jss-emburden.html">JSS Package Manuscript</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericscheier/emburden"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Workflow Deployment Guide</h1>
      <small class="dont-index">Source: <a href="https://github.com/ericscheier/emburden/blob/v0.5.10/WORKFLOW-DEPLOYMENT-GUIDE.md" class="external-link"><code>WORKFLOW-DEPLOYMENT-GUIDE.md</code></a></small>
    </div>

<div id="workflow-deployment-guide" class="section level1">

<p>This guide explains how to deploy the automatic CRAN workflow with approval gates to the public repository.</p>
<div class="section level2">
<h2 id="architecture-overview">Architecture Overview<a class="anchor" aria-label="anchor" href="#architecture-overview"></a></h2>
<p>The workflow system uses a <strong>two-repository architecture</strong> with automatic triggering and dual approval gates:</p>
<pre><code>PRIVATE REPO (ScheierVentures/emburden)
│
├── Push tag v0.6.0
│   └── auto-release.yml triggers
│       ├── Creates GitHub release (fast, ~10 seconds)
│       └── Triggers publish-to-public.yml
│           └── Syncs release and tags to PUBLIC REPO
│
PUBLIC REPO (ericscheier/emburden)
│
├── Release published event triggers controlled-release.yaml AUTOMATICALLY
│   ├── STAGE 1: CRAN validation (R CMD check, Win-builder, etc.)
│   ├── GATE 1: Pre-release review (manual approval required)
│   ├── STAGE 2: Update release with CRAN artifacts
│   ├── GATE 2: Final CRAN approval (manual approval required)
│   └── STAGE 3: CRAN submission guidance</code></pre>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a></h2>
<p>✅ <strong>Automatic Trigger</strong>: Workflow starts automatically when release is synced to public repo ✅ <strong>Dual Approval Gates</strong>: Two independent reviewers must approve before CRAN submission ✅ <strong>Comprehensive Validation</strong>: R CMD check –as-cran, Win-builder, URL checks, spell check ✅ <strong>No Conflicts</strong>: Auto-release creates release first, CRAN workflow updates it later ✅ <strong>Private-to-Public Flow</strong>: Maintains secure development in private repo</p>
</div>
<div class="section level2">
<h2 id="files-created">Files Created<a class="anchor" aria-label="anchor" href="#files-created"></a></h2>
<div class="section level3">
<h3 id="controlled-release-publicyaml"><code>controlled-release-public.yaml</code><a class="anchor" aria-label="anchor" href="#controlled-release-publicyaml"></a></h3>
<p>The automatic CRAN release workflow for the public repository (ericscheier/emburden).</p>
<p><strong>Location:</strong> <code>/home/ess/Documents/apps/net_energy_equity/controlled-release-public.yaml</code></p>
<p><strong>Key Differences from Manual Approach:</strong> - Triggers automatically on <code>release: types: [published]</code> event - Still includes <code>workflow_dispatch</code> for manual triggering if needed - Updates existing release (doesn’t create new one) - Runs after auto-release completes successfully</p>
</div>
</div>
<div class="section level2">
<h2 id="deployment-steps">Deployment Steps<a class="anchor" aria-label="anchor" href="#deployment-steps"></a></h2>
<div class="section level3">
<h3 id="id_1-ensure-pr-56-is-merged">1. Ensure PR #56 is Merged<a class="anchor" aria-label="anchor" href="#id_1-ensure-pr-56-is-merged"></a></h3>
<p>PR #56 removes the conflicting <code>controlled-release.yaml</code> from the private repository. Verify it’s merged:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">gh</span> pr view 56 <span class="at">--json</span> state,title</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-deploy-workflow-to-public-repository">2. Deploy Workflow to Public Repository<a class="anchor" aria-label="anchor" href="#id_2-deploy-workflow-to-public-repository"></a></h3>
<p>You’ll need to manually add the workflow file to the public repository (ericscheier/emburden):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Option A: Manual upload via GitHub UI</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">1.</span> Go to https://github.com/ericscheier/emburden</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">2.</span> Navigate to .github/workflows/</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">3.</span> Find existing controlled-release.yaml <span class="er">(</span><span class="ex">or</span> create new file<span class="kw">)</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="ex">4.</span> Replace entire contents with controlled-release-public.yaml</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="ex">5.</span> Commit directly to main branch</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># Option B: Via git (if you have write access)</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="bu">cd</span> /path/to/ericscheier/emburden</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">cp</span> /home/ess/Documents/apps/net_energy_equity/controlled-release-public.yaml .github/workflows/controlled-release.yaml</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">git</span> add .github/workflows/controlled-release.yaml</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"feat: Update to automatic CRAN workflow with dual approval gates</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="st">- Triggers automatically on release published events</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="st">- Maintains dual approval gates (pre-release-review and public-release)</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="st">- Updates existing releases with CRAN artifacts</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="st">- Keeps manual trigger option via workflow_dispatch"</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="fu">git</span> push origin main</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-verify-github-environments-public-repo">3. Verify GitHub Environments (Public Repo)<a class="anchor" aria-label="anchor" href="#id_3-verify-github-environments-public-repo"></a></h3>
<p>In the public repository (ericscheier/emburden), verify these two environments exist:</p>
<p><strong>Environment 1: <code>pre-release-review</code></strong> - Go to Settings → Environments - Verify environment exists with “Required reviewers” enabled - Should have 1-2 reviewers configured - If missing, create: - Go to Settings → Environments → New environment - Name: <code>pre-release-review</code> - Enable “Required reviewers” - Add 1-2 reviewers who will review CRAN validation results</p>
<p><strong>Environment 2: <code>public-release</code></strong> - Go to Settings → Environments - Verify environment exists with “Required reviewers” enabled - Should have 1-2 reviewers (preferably different from pre-release-review) - Optional: Enable “Wait timer” for cooling-off period - If missing, create it with required reviewers</p>
</div>
<div class="section level3">
<h3 id="id_4-optional-add-cran_email-secret">4. (Optional) Add CRAN_EMAIL Secret<a class="anchor" aria-label="anchor" href="#id_4-optional-add-cran_email-secret"></a></h3>
<p>For automatic Win-builder submission: - Go to Settings → Secrets and variables → Actions - Add repository secret: <code>CRAN_EMAIL</code> - Value: Your CRAN maintainer email address</p>
</div>
</div>
<div class="section level2">
<h2 id="how-the-automatic-workflow-works">How the Automatic Workflow Works<a class="anchor" aria-label="anchor" href="#how-the-automatic-workflow-works"></a></h2>
<div class="section level3">
<h3 id="for-regular-github-releases-fast---10-seconds">For Regular GitHub Releases (Fast - ~10 seconds)<a class="anchor" aria-label="anchor" href="#for-regular-github-releases-fast---10-seconds"></a></h3>
<ol style="list-style-type: decimal"><li>Push tag from private repo: <code>git tag v0.6.0 &amp;&amp; git push origin v0.6.0</code>
</li>
<li>
<code>auto-release.yml</code> creates GitHub release in private repo</li>
<li>
<code>publish-to-public.yml</code> syncs to public repo</li>
<li>Public repo now has the release</li>
<li>
<strong>CRAN workflow triggers automatically</strong> when release is published</li>
<li>Done! Fast release created, CRAN validation runs in background</li>
</ol></div>
<div class="section level3">
<h3 id="cran-validation-workflow-automatic-with-approval-gates">CRAN Validation Workflow (Automatic with Approval Gates)<a class="anchor" aria-label="anchor" href="#cran-validation-workflow-automatic-with-approval-gates"></a></h3>
<p>After the fast release is created, the CRAN workflow runs automatically:</p>
<ol style="list-style-type: decimal"><li>
<strong>STAGE 1 - Validation</strong> (automatic, ~5-10 minutes):
<ul><li>Checkout code at release tag</li>
<li>Run R CMD check –as-cran</li>
<li>Submit to Win-builder for Windows validation</li>
<li>Run URL validation</li>
<li>Run spell check</li>
<li>Build package tarball</li>
<li>Generate validation report</li>
</ul></li>
<li>
<strong>GATE 1 - Pre-Release Review</strong> (manual approval required):
<ul><li>Reviewer sees validation report</li>
<li>Reviews Win-builder email results (~30 min after submission)</li>
<li>Approves if all checks pass</li>
</ul></li>
<li>
<strong>STAGE 2 - Update Release</strong> (automatic after approval):
<ul><li>Downloads package tarball and validation report</li>
<li>Updates existing GitHub release with CRAN artifacts</li>
<li>Attaches tarball and validation report to release</li>
</ul></li>
<li>
<strong>GATE 2 - Final CRAN Approval</strong> (manual approval required):
<ul><li>Second reviewer verifies everything is ready</li>
<li>Reviews final checklist</li>
<li>Approves for CRAN submission</li>
</ul></li>
<li>
<strong>STAGE 3 - CRAN Guidance</strong> (automatic after approval):
<ul><li>Provides detailed CRAN submission instructions</li>
<li>Links to download tarball</li>
<li>Provides submission checklist</li>
</ul></li>
</ol></div>
<div class="section level3">
<h3 id="manual-trigger-if-needed">Manual Trigger (If Needed)<a class="anchor" aria-label="anchor" href="#manual-trigger-if-needed"></a></h3>
<p>You can still trigger the CRAN workflow manually:</p>
<ol style="list-style-type: decimal"><li>Go to public repo Actions tab: <a href="https://github.com/ericscheier/emburden/actions" class="external-link uri">https://github.com/ericscheier/emburden/actions</a>
</li>
<li>Select “Controlled Release” workflow</li>
<li>Click “Run workflow”</li>
<li>Enter version number (e.g., 0.6.0)</li>
<li>Workflow runs with same approval gates</li>
</ol></div>
</div>
<div class="section level2">
<h2 id="benefits-of-this-architecture">Benefits of This Architecture<a class="anchor" aria-label="anchor" href="#benefits-of-this-architecture"></a></h2>
<p>✅ <strong>Automatic Triggering</strong>: No need to manually start CRAN workflow ✅ <strong>No Conflicts</strong>: Auto-release creates release first, CRAN workflow updates it ✅ <strong>Fast GitHub Releases</strong>: Auto-release completes in ~10 seconds ✅ <strong>Thorough CRAN Validation</strong>: Comprehensive checks run automatically ✅ <strong>Dual Approval Gates</strong>: Two independent reviewers must approve ✅ <strong>Public Repository</strong>: CRAN submissions come from public repo (as intended) ✅ <strong>Flexible</strong>: Manual trigger still available if needed ✅ <strong>Private Development</strong>: Development happens in private repo securely</p>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a></h2>
<div class="section level3">
<h3 id="workflow-doesnt-trigger-automatically">Workflow Doesn’t Trigger Automatically<a class="anchor" aria-label="anchor" href="#workflow-doesnt-trigger-automatically"></a></h3>
<p><strong>Problem</strong>: CRAN workflow doesn’t start after release is synced to public repo.</p>
<p><strong>Check</strong>: 1. Verify workflow file exists in public repo: <code>.github/workflows/controlled-release.yaml</code> 2. Check workflow has correct trigger: <code>on: release: types: [published]</code> 3. Look for workflow errors in Actions tab</p>
</div>
<div class="section level3">
<h3 id="approval-gate-blocked">Approval Gate Blocked<a class="anchor" aria-label="anchor" href="#approval-gate-blocked"></a></h3>
<p><strong>Problem</strong>: Workflow waits at approval gate indefinitely.</p>
<p><strong>Solution</strong>: 1. Go to Actions tab in public repo 2. Find the running workflow 3. Click on the job waiting for approval 4. Review validation results 5. Approve via the environment approval UI</p>
</div>
<div class="section level3">
<h3 id="win-builder-results-not-received">Win-builder Results Not Received<a class="anchor" aria-label="anchor" href="#win-builder-results-not-received"></a></h3>
<p><strong>Problem</strong>: Win-builder email doesn’t arrive.</p>
<p><strong>Check</strong>: 1. Verify <code>CRAN_EMAIL</code> secret is set correctly 2. Check spam folder for win-builder emails 3. Wait up to 60 minutes (service can be slow) 4. Win-builder step is optional - you can proceed without it if needed</p>
</div>
</div>
<div class="section level2">
<h2 id="testing-the-workflow">Testing the Workflow<a class="anchor" aria-label="anchor" href="#testing-the-workflow"></a></h2>
<p>To test the workflow without creating a real release:</p>
<ol style="list-style-type: decimal"><li>Use the manual trigger option</li>
<li>Pick an existing version (e.g., 0.5.9)</li>
<li>Workflow will run validation and stop at approval gates</li>
<li>You can review the process without completing CRAN submission</li>
</ol></div>
<div class="section level2">
<h2 id="next-steps-after-deployment">Next Steps After Deployment<a class="anchor" aria-label="anchor" href="#next-steps-after-deployment"></a></h2>
<ol style="list-style-type: decimal"><li>
<strong>Test the workflow</strong>: Push a test tag to verify automatic triggering</li>
<li>
<strong>Update documentation</strong>: Update any README or wiki pages that reference the workflow</li>
<li>
<strong>Train reviewers</strong>: Ensure reviewers know how to use GitHub Environment approvals</li>
<li>
<strong>Monitor first run</strong>: Watch the first automatic run to ensure everything works</li>
</ol></div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h2>
<ul><li>CRAN submissions remain manual per CRAN requirements</li>
<li>The workflow guides you through submission but doesn’t auto-submit</li>
<li>Approval gates ensure quality control before CRAN submission</li>
<li>Win-builder validation is optional but recommended</li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Scheier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

