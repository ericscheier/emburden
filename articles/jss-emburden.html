<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>\pkg{emburden}: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,emburden: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,\pkg{emburden}: Temporal Energy Burden Analysis • emburden</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="\pkg{emburden}: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,emburden: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,\pkg{emburden}: Temporal Energy Burden Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">emburden</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.15</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Methodology</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/jss-emburden.html">JSS Package Manuscript</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ericscheier/emburden"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>\pkg{emburden}: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,emburden: Temporal Analysis of Household Energy Burden Using Net Energy Return Metrics,\pkg{emburden}: Temporal Energy Burden Analysis</h1>
                        <h4 data-toc-skip class="author">Eric
Scheier</h4>
            <address class="author_afil">
      Independent Researcher<br><small class="dont-index">Source: <a href="https://github.com/ericscheier/emburden/blob/main/vignettes/jss-emburden.Rmd" class="external-link"><code>vignettes/jss-emburden.Rmd</code></a></small>
      <div class="d-none name"><code>jss-emburden.Rmd</code></div>
    </address>
</div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>Energy burden—the proportion of household income spent on
      energy—is a critical metric for understanding energy poverty and
      inequity. However, traditional energy burden ratios present
      analytical challenges including difficulties with aggregation and
      visualization of extreme values. The package for implements Net
      Energy Return (Nh) methodology to address these limitations while
      enabling temporal analysis of household energy characteristics.
      This paper introduces the package’s design and demonstrates its
      application to comparing Low-Income Energy Affordability Data
      (LEAD) Tool vintages from 2018 and 2022 across geographic and
      demographic dimensions. The package provides functions for
      downloading, processing, and analyzing census tract-level energy
      burden data for all U.S. states, with particular attention to
      proper weighted aggregation and schema normalization across data
      vintages. We demonstrate the package’s capabilities through
      examples ranging from state-level summaries to fine-grained census
      tract comparisons, illustrating how policy-relevant insights can
      be extracted at multiple scales.</p>
    </div>
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Household energy affordability is a persistent challenge affecting
millions of households in the United States. Low-income households face
disproportionate energy burdens, often spending more than 6% of their
income on energy costs compared to 2-3% for higher-income households
<span class="citation">(Ross, Drehobl, and Stickles 2018; Drehobl and
Ross 2016)</span>. Understanding these disparities and tracking changes
over time is essential for designing effective energy assistance
programs and policies.</p>
<p>The traditional energy burden metric—the ratio of energy expenditures
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>)
to gross income
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>)—has
several analytical limitations. As a ratio with income in the
denominator, energy burden
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>b</mi></msub><mo>=</mo><mi>S</mi><mi>/</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">E_b = S/G</annotation></semantics></math>)
approaches infinity for households with very low incomes, creating
challenges for aggregation and visualization. Additionally, the metric
requires harmonic mean aggregation rather than arithmetic means, which
is not widely understood or consistently applied <span class="citation">(Scheier and Kittner 2022)</span>.</p>
<div class="section level3">
<h3 id="mathematical-foundations">Mathematical foundations<a class="anchor" aria-label="anchor" href="#mathematical-foundations"></a>
</h3>
<p>The package for addresses these challenges by implementing Net Energy
Return (NER) methodology, adapted from macro-energy systems analysis
<span class="citation">(Hall, Lambert, and Balogh 2011; Brandt, Dale,
and Barnhart 2013; Carbajales-Dale et al. 2014)</span>. Net energy
analysis estimates the net energy return of a process as a relationship
between gross resources extracted and embodied energy directed toward
extraction:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mi>G</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mspace width="0.222em"></mspace><mi>R</mi><mi>e</mi><mi>s</mi><mi>o</mi><mi>u</mi><mi>r</mi><mi>c</mi><mi>e</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>x</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">G = Gross\ Resource\ Extracted</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>S</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>o</mi><mi>n</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>x</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mspace width="0.222em"></mspace><mi>P</mi><mi>r</mi><mi>o</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">S = Spending\ on\ Extraction\ Process</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>t</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mspace width="0.222em"></mspace><mi>R</mi><mi>e</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>n</mi><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mi>E</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>G</mi><mo>−</mo><mi>S</mi></mrow><mi>S</mi></mfrac></mrow><annotation encoding="application/x-tex">Net\ Energy\ Return\ (NER) = \frac{G - S}{S}</annotation></semantics></math></p>
<p>For households extracting income from the economy, these ratios
become:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mrow><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>G</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mspace width="0.222em"></mspace><mi>I</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">G_{income} = Gross\ Income</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow></msub><mo>=</mo><mi>S</mi><mi>p</mi><mi>e</mi><mi>n</mi><mi>d</mi><mi>i</mi><mi>n</mi><mi>g</mi><mspace width="0.222em"></mspace><mi>o</mi><mi>n</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">S_{energy} = Spending\ on\ Energy</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>E</mi><msub><mi>R</mi><mrow><mi>h</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>G</mi><mrow><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>−</mo><msub><mi>S</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow></msub></mrow><msub><mi>S</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">NER_{household} = \frac{G_{income} - S_{energy}}{S_{energy}}</annotation></semantics></math></p>
<p>This metric represents the net earnings a household receives for
every dollar of expenditure on secondary energy. For notational
simplicity, we use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>h</mi></msub><annotation encoding="application/x-tex">N_h</annotation></semantics></math>
to denote household Net Energy Return throughout this paper, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>h</mi></msub><mo>=</mo><mi>N</mi><mi>E</mi><msub><mi>R</mi><mrow><mi>h</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">N_h = NER_{household}</annotation></semantics></math>.</p>
<div class="section level4">
<h4 id="comparison-with-energy-burden">Comparison with energy burden<a class="anchor" aria-label="anchor" href="#comparison-with-energy-burden"></a>
</h4>
<p>Energy burden, the traditional metric in energy poverty analysis, is
defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mspace width="0.222em"></mspace><mi>B</mi><mi>u</mi><mi>r</mi><mi>d</mi><mi>e</mi><mi>n</mi><mo>=</mo><msub><mi>E</mi><mi>b</mi></msub><mo>=</mo><mfrac><msub><mi>S</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow></msub><msub><mi>G</mi><mrow><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">Energy\ Burden = E_b = \frac{S_{energy}}{G_{income}}</annotation></semantics></math></p>
<p>While energy burden is intuitive as a percentage, it has several
mathematical limitations. The Net Energy Return transformation addresses
these by preventing double-counting of energy expenditures (income in
the numerator already includes the portion spent on energy) and enabling
proper weighted mean aggregation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>N</mi><mi>h</mi></msub><mo accent="true">¯</mo></mover><mo>=</mo><mfrac><mrow><mo>∑</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>h</mi></msub><mo>×</mo><mi>h</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi><mi>s</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mo>∑</mo><mi>h</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi><mi>s</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\overline{N_h} = \frac{\sum (N_h \times households)}{\sum households}</annotation></semantics></math></p>
<p>In contrast, energy burden requires harmonic mean aggregation:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><msub><mi>E</mi><mi>b</mi></msub><mo accent="true">¯</mo></mover><mo>=</mo><mfrac><mn>1</mn><mover><mrow><mn>1</mn><mi>/</mi><msub><mi>E</mi><mi>b</mi></msub></mrow><mo accent="true">¯</mo></mover></mfrac></mrow><annotation encoding="application/x-tex">\overline{E_b} = \frac{1}{\overline{1/E_b}}</annotation></semantics></math></p>
<p>The two metrics are mathematically related through the transformation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>b</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>N</mi><mi>h</mi></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_b = 1/(N_h + 1)</annotation></semantics></math>,
allowing seamless conversion between representations.</p>
</div>
<div class="section level4">
<h4 id="energy-poverty-threshold">Energy poverty threshold<a class="anchor" aria-label="anchor" href="#energy-poverty-threshold"></a>
</h4>
<p>Energy poverty is commonly defined as spending greater than 10% of
household income on energy <span class="citation">(Bednar and Reames
2020)</span>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>E</mi><mi>b</mi><mo>*</mo></msubsup><mo>=</mo><mfrac><msub><mi>S</mi><mrow><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi></mrow></msub><msub><mi>G</mi><mrow><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub></mfrac><mo>&gt;</mo><mn>10</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">E_b^{*} = \frac{S_{energy}}{G_{income}} &gt; 10\%</annotation></semantics></math></p>
<p>Translated to Net Energy Return, the energy poverty threshold
becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mi>h</mi><mo>*</mo></msubsup><mo>&lt;</mo><mn>9</mn><mo>:</mo><mi>H</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi><mspace width="0.222em"></mspace><mi>a</mi><mi>t</mi><mspace width="0.222em"></mspace><mi>E</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>g</mi><mi>y</mi><mspace width="0.222em"></mspace><mi>P</mi><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>y</mi><mspace width="0.222em"></mspace><mi>L</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">N_h^{*} &lt; 9: Household\ at\ Energy\ Poverty\ Line</annotation></semantics></math></p>
<p>This means a household earning less than $9 of income for every
dollar spent on secondary energy is considered to be in energy poverty
by the traditional energy burden accounting method. A Net Energy Return
of 9 or lower is equivalent to an energy burden of 10% or higher. While
this threshold is somewhat arbitrary and may not be suitable in all
situations, it provides a useful benchmark for comparing results to the
energy poverty literature.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-lead-tool-and-temporal-analysis">The LEAD Tool and temporal analysis<a class="anchor" aria-label="anchor" href="#the-lead-tool-and-temporal-analysis"></a>
</h3>
<p>The U.S. Department of Energy’s Low-Income Energy Affordability Data
(LEAD) Tool <span class="citation">(Ma et al. 2019)</span> provides
census tract-level estimates of household energy characteristics based
on American Community Survey microdata. The tool uses iterative
proportional fitting to allocate households to census tracts while
calibrating to utility-reported sales and revenues.</p>
<p>Multiple vintages of LEAD Tool data have been released:</p>
<ul>
<li>
<strong>2018 Update</strong>: Based on 2018 5-year ACS data,
released July 2020</li>
<li>
<strong>2022 Update</strong>: Based on 2022 5-year ACS data,
released August 2024</li>
</ul>
<p>These vintages enable temporal analysis of energy burden trends, but
require careful handling of schema differences and income bracket
definitions.</p>
</div>
<div class="section level3">
<h3 id="package-design-philosophy">Package design philosophy<a class="anchor" aria-label="anchor" href="#package-design-philosophy"></a>
</h3>
<p>The package is designed around several key principles:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Proper aggregation</strong>: Implements weighted mean
aggregation using Net Energy Return, with household counts as
weights</li>
<li>
<strong>Temporal consistency</strong>: Normalizes schema differences
between LEAD Tool vintages to enable valid comparisons</li>
<li>
<strong>Flexible workflows</strong>: Supports both database and
CSV-based data access with automatic fallback</li>
<li>
<strong>Geographic flexibility</strong>: Enables analysis from
national level down to individual census tracts</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<div class="section level3">
<h3 id="data-sources">Data sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h3>
<p>The package provides access to three primary datasets for household
energy burden analysis:</p>
<div class="section level4">
<h4 id="lead-tool">LEAD Tool<a class="anchor" aria-label="anchor" href="#lead-tool"></a>
</h4>
<p>The Low-Income Energy Affordability Data (LEAD) Tool <span class="citation">(Ma et al. 2019)</span> portrays average income,
electricity expenditures, gas expenditures, and other fuel expenditures
for cohorts of households segmented by location (census tract, county,
state) and household characteristics (ownership status, building age,
number of units, attachment status, primary heating fuel).</p>
<p>The dataset is assembled using iterative proportional fitting (IPF),
a widely used spatial microsimulation method to allocate households to
census tracts while calibrating characteristics to known quantities. The
IPF algorithm processes cross-tabulations of household responses from
the American Community Survey (ACS) Public Use Microdata Samples,
scaling them to match aggregate annual values from utility sales and
revenues reported in Energy Information Administration forms 861
(electricity) and 176 (natural gas).</p>
<p>Multiple vintages are available:</p>
<ul>
<li>
<strong>2018 Update</strong>: Based on 2016 5-year ACS data
(2012-2016), released July 2020</li>
<li>
<strong>2022 Update</strong>: Based on 2018 5-year ACS data
(2014-2018), released August 2024</li>
</ul>
</div>
<div class="section level4">
<h4 id="replica-dataset">REPLICA dataset<a class="anchor" aria-label="anchor" href="#replica-dataset"></a>
</h4>
<p>The Renewable Energy Potential of Low-Income Communities in America
(REPLICA) dataset <span class="citation">(Sigrin and Mooney 2018)</span>
adds technical rooftop solar potential and additional techno-economic
variables including demographics and electricity rates. The package can
merge REPLICA data with LEAD data to enrich analyses with utility type,
locale classification, and solar generation potential.</p>
</div>
<div class="section level4">
<h4 id="schema-normalization-across-vintages">Schema normalization across vintages<a class="anchor" aria-label="anchor" href="#schema-normalization-across-vintages"></a>
</h4>
<p>A critical challenge in temporal analysis is handling schema
differences between LEAD Tool vintages. The package implements automatic
normalization through the following transformations:</p>
<p><strong>Income bracket aggregation</strong>: The LEAD Tool provides
income as a fraction of Area Median Income (AMI) or Federal Poverty
Level (FPL). For AMI data, the package can aggregate detailed brackets
into simplified categories matching the REPLICA schema:</p>
<ul>
<li>0-30% AMI: Very Low Income</li>
<li>30-80% AMI: Low-to-Moderate Income</li>
<li>80%+ AMI: Middle-to-High Income</li>
</ul>
<p>For FPL data, the aggregation follows poverty line definitions:</p>
<ul>
<li>0-100% FPL: In Poverty</li>
<li>100%+ FPL: Not In Poverty</li>
</ul>
<p><strong>Building type simplification</strong>: Housing units are
classified as:</p>
<ul>
<li>1 Unit: Single-Family</li>
<li><blockquote>
<p>1 Unit: Multi-Family</p>
</blockquote></li>
<li>Other Unit: Excluded from analysis</li>
</ul>
<p>These normalizations enable valid temporal comparisons despite
underlying schema evolution between vintages.</p>
</div>
</div>
<div class="section level3">
<h3 id="data-processing">Data processing<a class="anchor" aria-label="anchor" href="#data-processing"></a>
</h3>
<p>The package processes raw LEAD Tool data through several stages:</p>
<div class="section level4">
<h4 id="energy-burden-indicator-calculation">Energy burden indicator calculation<a class="anchor" aria-label="anchor" href="#energy-burden-indicator-calculation"></a>
</h4>
<p>For each household cohort, the package calculates:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mi>e</mi><mi>l</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>c</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo>+</mo><mi>n</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>g</mi><mi>a</mi><mi>s</mi><mo>+</mo><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mspace width="0.222em"></mspace><mi>f</mi><mi>u</mi><mi>e</mi><mi>l</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">s = electricity + natural\ gas + other\ fuels</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><mi>a</mi><mi>n</mi><mi>n</mi><mi>u</mi><mi>a</mi><mi>l</mi><mspace width="0.222em"></mspace><mi>h</mi><mi>o</mi><mi>u</mi><mi>s</mi><mi>e</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>d</mi><mspace width="0.222em"></mspace><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">g = annual\ household\ income</annotation></semantics></math></p>
<p>From these base metrics, all energy burden indicators are derived
using the formulas presented in Section 1.1.</p>
</div>
<div class="section level4">
<h4 id="weighted-aggregation">Weighted aggregation<a class="anchor" aria-label="anchor" href="#weighted-aggregation"></a>
</h4>
<p>The package implements proper weighted aggregation using household
counts as weights. For Net Energy Return:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_weighted_metrics.html">calculate_weighted_metrics</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  group_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"income_bracket"</span><span class="op">)</span>,</span>
<span>  metric_name <span class="op">=</span> <span class="st">"ner"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This function:</p>
<ol style="list-style-type: decimal">
<li>Filters data to specified groups</li>
<li>Calculates weighted means using household counts</li>
<li>Computes poverty rates below specified thresholds</li>
<li>Returns summary statistics including quantiles and standard
deviations</li>
</ol>
<p>The key insight is that Net Energy Return allows arithmetic weighted
means, while energy burden would require harmonic mean aggregation—a
distinction that significantly impacts the validity and interpretability
of aggregate statistics.</p>
</div>
<div class="section level4">
<h4 id="data-quality-considerations">Data quality considerations<a class="anchor" aria-label="anchor" href="#data-quality-considerations"></a>
</h4>
<p>Iterative proportional fitting has limitations as an estimation
procedure. The relationship between constraint variables tends toward
the average of the initializing dataset, potentially depressing
variations among otherwise similar regions. This may explain the large
quantities of households estimated to have very low incomes. Validating
these estimated data would require randomized surveys along the
dimensions of interest.</p>
<p>Additionally, the “primary heating fuel” category derives from the
ACS question “Which fuel is used most for heating this house, apartment,
or mobile home?” The predictive power of this question for energy
expenditures is not fully understood and warrants caution in
interpretation.</p>
<p>Though REPLICA relies on a different LEAD vintage (2017) than recent
analyses (2019, 2022), the package still enables useful cross-dataset
analysis. However, inferring differences among annual estimates should
account for the standard error of the data <span class="citation">(Ma et
al. 2019)</span>. Rigorous temporal analysis benefits from comparing
identically-processed vintages.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="package-architecture">Package architecture<a class="anchor" aria-label="anchor" href="#package-architecture"></a>
</h2>
<p>The package is organized into several functional modules:</p>
<div class="section level3">
<h3 id="core-functions">Core functions<a class="anchor" aria-label="anchor" href="#core-functions"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ericscheier/emburden" class="external-link">emburden</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Energy metric calculations</span></span>
<span><span class="fu"><a href="../reference/energy_burden_func.html">energy_burden_func</a></span><span class="op">(</span><span class="va">gross_income</span>, <span class="va">energy_spending</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ner_func.html">ner_func</a></span><span class="op">(</span><span class="va">gross_income</span>, <span class="va">energy_spending</span><span class="op">)</span>  <span class="co"># Net Energy Return</span></span>
<span><span class="fu"><a href="../reference/eroi_func.html">eroi_func</a></span><span class="op">(</span><span class="va">gross_income</span>, <span class="va">energy_spending</span><span class="op">)</span>  <span class="co"># EROI</span></span>
<span><span class="fu"><a href="../reference/dear_func.html">dear_func</a></span><span class="op">(</span><span class="va">gross_income</span>, <span class="va">energy_spending</span><span class="op">)</span>  <span class="co"># DEAR</span></span>
<span></span>
<span><span class="co"># Statistical aggregation</span></span>
<span><span class="fu"><a href="../reference/calculate_weighted_metrics.html">calculate_weighted_metrics</a></span><span class="op">(</span></span>
<span>  <span class="va">graph_data</span>,</span>
<span>  group_columns <span class="op">=</span> <span class="st">"state"</span>,</span>
<span>  metric_name <span class="op">=</span> <span class="st">"ner"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-loading-functions">Data loading functions<a class="anchor" aria-label="anchor" href="#data-loading-functions"></a>
</h3>
<p>The package provides automatic data downloading and caching:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load census tract data (auto-downloads if not available)</span></span>
<span><span class="va">nc_tracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_census_tract_data.html">load_census_tract_data</a></span><span class="op">(</span>states <span class="op">=</span> <span class="st">"NC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load cohort data by income bracket</span></span>
<span><span class="va">nc_ami</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_cohort_data.html">load_cohort_data</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  vintage <span class="op">=</span> <span class="st">"2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare vintages</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"state"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-examples">Analysis examples<a class="anchor" aria-label="anchor" href="#analysis-examples"></a>
</h2>
<p>The package’s primary contribution is enabling temporal analysis of
energy burden through proper schema normalization and aggregation. This
section demonstrates the package’s capabilities through progressively
detailed examples.</p>
<div class="section level3">
<h3 id="temporal-comparison-workflow">Temporal comparison workflow<a class="anchor" aria-label="anchor" href="#temporal-comparison-workflow"></a>
</h3>
<p>The <code><a href="../reference/compare_energy_burden.html">compare_energy_burden()</a></code> function provides the core
temporal analysis functionality:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ericscheier/emburden" class="external-link">emburden</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare North Carolina energy burden: 2018 vs 2022</span></span>
<span><span class="va">nc_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"income_bracket"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View formatted comparison table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nc_comparison</span><span class="op">)</span></span></code></pre></div>
<p>The function automatically:</p>
<ol style="list-style-type: decimal">
<li>Downloads both vintages if not cached locally</li>
<li>Normalizes schema differences between vintages</li>
<li>Performs proper
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>h</mi></msub><annotation encoding="application/x-tex">N_h</annotation></semantics></math>-based
weighted aggregation</li>
<li>Calculates energy burden for both periods</li>
<li>Computes changes in percentage points</li>
</ol>
<div class="section level4">
<h4 id="understanding-the-output">Understanding the output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h4>
<p>The comparison object contains multiple metrics:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Energy burden in 2018 and 2022</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">neb_2018</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">neb_2022</span></span>
<span></span>
<span><span class="co"># Change in energy burden (percentage points)</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">neb_change_pp</span></span>
<span></span>
<span><span class="co"># Net Energy Return values</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">ner_2018</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">ner_2022</span></span>
<span></span>
<span><span class="co"># Household counts</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">households_2018</span></span>
<span><span class="va">nc_comparison</span><span class="op">$</span><span class="va">households_2022</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="example-1-state-level-temporal-analysis">Example 1: State-level temporal analysis<a class="anchor" aria-label="anchor" href="#example-1-state-level-temporal-analysis"></a>
</h3>
<p>To examine overall state changes without grouping by demographic
characteristics:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall state comparison</span></span>
<span><span class="va">nc_state</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"none"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract key findings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"North Carolina energy burden changed from %.1f%% (2018) to %.1f%% (2022)\n"</span>,</span>
<span>  <span class="va">nc_state</span><span class="op">$</span><span class="va">neb_2018</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>  <span class="va">nc_state</span><span class="op">$</span><span class="va">neb_2022</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"Change: %+.2f percentage points\n"</span>,</span>
<span>  <span class="va">nc_state</span><span class="op">$</span><span class="va">neb_change_pp</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-income-bracket-analysis">Example 2: Income bracket analysis<a class="anchor" aria-label="anchor" href="#example-2-income-bracket-analysis"></a>
</h3>
<p>Disaggregating by income bracket reveals which populations
experienced the largest changes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare by income bracket</span></span>
<span><span class="va">nc_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"income_bracket"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize changes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">nc_income</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">income_bracket</span>, y <span class="op">=</span> <span class="va">neb_change_pp</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Change in Energy Burden by Income Bracket"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"North Carolina, 2018 to 2022"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Income Bracket (% of Area Median Income)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Change in Energy Burden (percentage points)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Typical findings show that very low-income households (0-30% AMI)
experience the highest energy burdens and are most vulnerable to changes
in energy costs or income levels.</p>
</div>
<div class="section level3">
<h3 id="example-3-multi-state-comparison">Example 3: Multi-state comparison<a class="anchor" aria-label="anchor" href="#example-3-multi-state-comparison"></a>
</h3>
<p>Comparing multiple states reveals regional patterns and policy
impacts:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare Southern states</span></span>
<span><span class="va">southern_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NC"</span>, <span class="st">"SC"</span>, <span class="st">"GA"</span>, <span class="st">"FL"</span><span class="op">)</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"state"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Which states improved most?</span></span>
<span><span class="va">southern_states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">neb_change_pp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">state_abbr</span>, <span class="va">neb_2018</span>, <span class="va">neb_2022</span>, <span class="va">neb_change_pp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize state comparison</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">southern_states</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">state_abbr</span>, <span class="va">neb_2022</span><span class="op">)</span>,</span>
<span>                             y <span class="op">=</span> <span class="va">neb_2022</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">neb_2018</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Energy Burden by State: 2022 (bars) vs 2018 (points)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"State"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Energy Burden (%)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-4-housing-tenure-analysis">Example 4: Housing tenure analysis<a class="anchor" aria-label="anchor" href="#example-4-housing-tenure-analysis"></a>
</h3>
<p>Energy burden often varies significantly between renters and
homeowners:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare by housing tenure</span></span>
<span><span class="va">nc_tenure</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"housing_tenure"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the renter-owner gap</span></span>
<span><span class="va">gap_2018</span> <span class="op">&lt;-</span> <span class="va">nc_tenure</span><span class="op">$</span><span class="va">neb_2018</span><span class="op">[</span><span class="va">nc_tenure</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"RENTER"</span><span class="op">]</span> <span class="op">-</span></span>
<span>            <span class="va">nc_tenure</span><span class="op">$</span><span class="va">neb_2018</span><span class="op">[</span><span class="va">nc_tenure</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"OWNER"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gap_2022</span> <span class="op">&lt;-</span> <span class="va">nc_tenure</span><span class="op">$</span><span class="va">neb_2022</span><span class="op">[</span><span class="va">nc_tenure</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"RENTER"</span><span class="op">]</span> <span class="op">-</span></span>
<span>            <span class="va">nc_tenure</span><span class="op">$</span><span class="va">neb_2022</span><span class="op">[</span><span class="va">nc_tenure</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"OWNER"</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span>
<span>  <span class="st">"Renter-Owner energy burden gap: %.2f pp (2018) → %.2f pp (2022)\n"</span>,</span>
<span>  <span class="va">gap_2018</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>  <span class="va">gap_2022</span> <span class="op">*</span> <span class="fl">100</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Renters typically face higher energy burdens due to split-incentive
problems where landlords make efficiency investment decisions but
tenants pay energy bills.</p>
</div>
<div class="section level3">
<h3 id="example-5-federal-poverty-line-analysis">Example 5: Federal Poverty Line analysis<a class="anchor" aria-label="anchor" href="#example-5-federal-poverty-line-analysis"></a>
</h3>
<p>For policy applications targeting households below the federal
poverty line:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use FPL dataset instead of AMI</span></span>
<span><span class="va">nc_fpl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"fpl"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"income_bracket"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare poverty vs non-poverty households</span></span>
<span><span class="va">nc_fpl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">income_bracket</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Below Federal Poverty Line"</span>,</span>
<span>                                <span class="st">"Above Federal Poverty Line"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">income_bracket</span>, <span class="va">neb_2018</span>, <span class="va">neb_2022</span>, <span class="va">neb_change_pp</span><span class="op">)</span></span></code></pre></div>
<p>This analysis is particularly relevant for programs like the
Low-Income Home Energy Assistance Program (LIHEAP) which target
households below specific poverty thresholds.</p>
</div>
<div class="section level3">
<h3 id="example-6-census-tract-level-analysis">Example 6: Census tract-level analysis<a class="anchor" aria-label="anchor" href="#example-6-census-tract-level-analysis"></a>
</h3>
<p>For fine-grained spatial analysis, load tract-level data
directly:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load 2022 census tract data</span></span>
<span><span class="va">nc_tracts_2022</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_census_tract_data.html">load_census_tract_data</a></span><span class="op">(</span></span>
<span>  states <span class="op">=</span> <span class="st">"NC"</span>,</span>
<span>  vintage <span class="op">=</span> <span class="st">"2022"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate county-level statistics</span></span>
<span><span class="va">nc_counties</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_weighted_metrics.html">calculate_weighted_metrics</a></span><span class="op">(</span></span>
<span>  <span class="va">nc_tracts_2022</span>,</span>
<span>  group_columns <span class="op">=</span> <span class="st">"county_name"</span>,</span>
<span>  metric_name <span class="op">=</span> <span class="st">"ner"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify counties with highest energy burden</span></span>
<span><span class="va">nc_counties</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>energy_burden <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">ner</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">energy_burden</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">county_name</span>, <span class="va">energy_burden</span>, <span class="va">household_count</span><span class="op">)</span></span></code></pre></div>
<p>Census tract data enables spatial analysis and mapping applications,
revealing urban-rural disparities and identifying communities in need of
targeted assistance.</p>
</div>
</div>
<div class="section level2">
<h2 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h2>
<div class="section level3">
<h3 id="policy-implications">Policy implications<a class="anchor" aria-label="anchor" href="#policy-implications"></a>
</h3>
<p>The ability to track energy burden changes over time has important
policy implications. Programs like LIHEAP (Low-Income Home Energy
Assistance Program) and WAP (Weatherization Assistance Program) target
households experiencing energy insecurity, but evaluating their
effectiveness requires robust temporal analysis.</p>
<p>The package enables researchers and policymakers to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Track program impacts</strong>: Compare energy burden before
and after policy interventions</li>
<li>
<strong>Identify vulnerable populations</strong>: Disaggregate
trends by income, tenure, and geography</li>
<li>
<strong>Allocate resources effectively</strong>: Target communities
with worsening energy affordability</li>
<li>
<strong>Benchmark across jurisdictions</strong>: Compare state and
local policy outcomes</li>
</ol>
<div class="section level4">
<h4 id="split-incentive-and-principal-agent-problems">Split-incentive and principal-agent problems<a class="anchor" aria-label="anchor" href="#split-incentive-and-principal-agent-problems"></a>
</h4>
<p>A persistent challenge in energy equity is the split-incentive
problem: landlords make energy efficiency investment decisions, but
tenants pay the energy bills. This misalignment of incentives leads to
underinvestment in efficiency improvements for rental properties.</p>
<p>The package’s ability to analyze energy burden by housing tenure
reveals the magnitude of this problem:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quantify the renter-owner gap</span></span>
<span><span class="va">tenure_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_energy_burden.html">compare_energy_burden</a></span><span class="op">(</span></span>
<span>  dataset <span class="op">=</span> <span class="st">"ami"</span>,</span>
<span>  states <span class="op">=</span> <span class="st">"all"</span>,  <span class="co"># National analysis</span></span>
<span>  group_by <span class="op">=</span> <span class="st">"housing_tenure"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate disparity</span></span>
<span><span class="va">renter_burden</span> <span class="op">&lt;-</span> <span class="va">tenure_comparison</span><span class="op">$</span><span class="va">neb_2022</span><span class="op">[</span></span>
<span>  <span class="va">tenure_comparison</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"RENTER"</span></span>
<span><span class="op">]</span></span>
<span><span class="va">owner_burden</span> <span class="op">&lt;-</span> <span class="va">tenure_comparison</span><span class="op">$</span><span class="va">neb_2022</span><span class="op">[</span></span>
<span>  <span class="va">tenure_comparison</span><span class="op">$</span><span class="va">housing_tenure</span> <span class="op">==</span> <span class="st">"OWNER"</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">disparity_ratio</span> <span class="op">&lt;-</span> <span class="va">renter_burden</span> <span class="op">/</span> <span class="va">owner_burden</span></span></code></pre></div>
<p>Addressing this gap requires policy interventions such as:</p>
<ul>
<li>On-bill financing programs</li>
<li>Landlord incentive programs</li>
<li>Energy efficiency standards for rental properties</li>
<li>Community-scale renewable energy projects</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="data-limitations-and-considerations">Data limitations and considerations<a class="anchor" aria-label="anchor" href="#data-limitations-and-considerations"></a>
</h3>
<p>Users should be aware of several data limitations:</p>
<div class="section level4">
<h4 id="iterative-proportional-fitting-constraints">Iterative proportional fitting constraints<a class="anchor" aria-label="anchor" href="#iterative-proportional-fitting-constraints"></a>
</h4>
<p>The LEAD Tool uses IPF to allocate households to census tracts, which
has important implications:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Regression toward the mean</strong>: IPF tends to depress
variations among similar regions</li>
<li>
<strong>Estimation uncertainty</strong>: Standard errors are
substantial, especially for small cohorts</li>
<li>
<strong>Temporal comparability</strong>: Different ACS vintages may
have methodological differences</li>
</ol>
</div>
<div class="section level4">
<h4 id="income-measurement-challenges">Income measurement challenges<a class="anchor" aria-label="anchor" href="#income-measurement-challenges"></a>
</h4>
<p>Household income as reported in the ACS has known limitations:</p>
<ul>
<li>
<strong>Underreporting</strong>: Particularly for benefits and
informal income</li>
<li>
<strong>Timing</strong>: Income is annual but energy costs vary
seasonally</li>
<li>
<strong>Household composition</strong>: Per-capita income may be
more relevant for some analyses</li>
</ul>
</div>
<div class="section level4">
<h4 id="energy-expenditure-estimation">Energy expenditure estimation<a class="anchor" aria-label="anchor" href="#energy-expenditure-estimation"></a>
</h4>
<p>The “primary heating fuel” categorization derives from a single ACS
question and may not fully capture:</p>
<ul>
<li>Mixed-fuel households</li>
<li>Behavioral patterns</li>
<li>Appliance efficiency variations</li>
<li>Climate variations within states</li>
</ul>
<p>Despite these limitations, the LEAD Tool represents the most
comprehensive spatial dataset available for energy burden analysis in
the United States.</p>
</div>
</div>
<div class="section level3">
<h3 id="future-research-directions">Future research directions<a class="anchor" aria-label="anchor" href="#future-research-directions"></a>
</h3>
<p>Several extensions would enhance the package’s capabilities:</p>
<div class="section level4">
<h4 id="additional-vintages">Additional vintages<a class="anchor" aria-label="anchor" href="#additional-vintages"></a>
</h4>
<p>As DOE releases new LEAD Tool vintages (potentially 2024, 2026,
etc.), the package can incorporate them to enable longer-term trend
analysis. This would support:</p>
<ul>
<li>Multi-year trend identification</li>
<li>Correlation with economic cycles</li>
<li>Climate change impact assessment</li>
</ul>
</div>
<div class="section level4">
<h4 id="additional-metrics">Additional metrics<a class="anchor" aria-label="anchor" href="#additional-metrics"></a>
</h4>
<p>The package currently implements Net Energy Return, EROI, and DEAR.
Future versions could add:</p>
<ul>
<li>
<strong>Disposable income ratios</strong>: Accounting for essential
expenses beyond energy</li>
<li>
<strong>Energy poverty depth</strong>: How far below thresholds
households fall</li>
<li>
<strong>Vulnerability indices</strong>: Combining burden with
demographic risk factors</li>
</ul>
</div>
<div class="section level4">
<h4 id="spatial-analysis-enhancements">Spatial analysis enhancements<a class="anchor" aria-label="anchor" href="#spatial-analysis-enhancements"></a>
</h4>
<p>Geographic extensions could include:</p>
<ul>
<li>Integration with climate zone data</li>
<li>Utility service territory analysis</li>
<li>Transportation energy burden incorporation</li>
<li>Built environment characteristics</li>
</ul>
</div>
<div class="section level4">
<h4 id="causal-analysis-tools">Causal analysis tools<a class="anchor" aria-label="anchor" href="#causal-analysis-tools"></a>
</h4>
<p>Methodological extensions for policy evaluation:</p>
<ul>
<li>Difference-in-differences estimation</li>
<li>Synthetic control methods</li>
<li>Regression discontinuity designs</li>
<li>Propensity score matching</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="comparison-with-existing-tools">Comparison with existing tools<a class="anchor" aria-label="anchor" href="#comparison-with-existing-tools"></a>
</h3>
<p>Several tools exist for energy burden analysis, each with different
strengths:</p>
<ul>
<li>
<strong>LEAD Tool web interface</strong>: Interactive but limited
temporal comparison</li>
<li>
<strong>State energy office tools</strong>: Customized but not
standardized across states</li>
<li>
<strong>Academic datasets</strong>: Rich but often one-time
snapshots</li>
<li>
<strong></strong>: Focused on temporal analysis with proper
aggregation methodology</li>
</ul>
<p>The package fills a gap by providing programmatic access to multiple
vintages with automated schema normalization, enabling reproducible
temporal analyses at scale.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The package provides a robust framework for temporal analysis of
household energy burden using proper Net Energy Return methodology. By
automating data access, normalizing schema differences, and implementing
correct aggregation methods, the package enables researchers and
policymakers to track energy affordability trends across multiple
scales.</p>
<p>Key contributions include:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Mathematical foundations</strong>: Proper Net Energy Return
aggregation avoiding double-counting</li>
<li>
<strong>Temporal consistency</strong>: Automated schema
normalization across LEAD Tool vintages</li>
<li>
<strong>Flexible analysis</strong>: Functions supporting national,
state, county, and tract-level analysis</li>
<li>
<strong>Policy relevance</strong>: Direct support for energy
assistance program evaluation</li>
</ol>
<p>The package is available from GitHub at and is licensed under
AGPL-3+. Documentation, vignettes, and issue tracking are available
through the package website.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bednarrecognition2020" class="csl-entry">
Bednar, Dominic J, and Tony G Reames. 2020. <span>“Recognition of and
Response to Energy Poverty in the United States.”</span> <em>Nature
Energy</em> 5 (6): 432–39. <a href="https://doi.org/10.1038/s41560-020-0582-0" class="external-link">https://doi.org/10.1038/s41560-020-0582-0</a>.
</div>
<div id="ref-brandtcalculating2013" class="csl-entry">
Brandt, Adam R, Michael Dale, and Charles J Barnhart. 2013.
<span>“Calculating Systems-Scale Energy Efficiency and Net Energy
Returns: A Bottom-up Matrix-Based Approach.”</span> <em>Energy</em> 62:
235–47. <a href="https://doi.org/10.1016/j.energy.2013.09.054" class="external-link">https://doi.org/10.1016/j.energy.2013.09.054</a>.
</div>
<div id="ref-carbajalesdale2014better" class="csl-entry">
Carbajales-Dale, Michael, Charles J Barnhart, Adam R Brandt, and Sally M
Benson. 2014. <span>“Can We Better Understand How Nations Produce and
Consume Energy and Economic Resources? Integrating Approaches from
Ecology, Energy Analysis, and Economics.”</span> <em>Energies</em> 7
(3): 1347–96.
</div>
<div id="ref-drehobl2016lifting" class="csl-entry">
Drehobl, Ariel, and Lauren Ross. 2016. <span>“Lifting the High Energy
Burden in America’s Largest Cities: How Energy Efficiency Can Improve
Low Income and Underserved Communities.”</span> American Council for an
Energy-Efficient Economy.
</div>
<div id="ref-hall2011eroi" class="csl-entry">
Hall, Charles AS, Jessica G Lambert, and Stephen B Balogh. 2011.
<span>“EROI of Different Fuels and the Implications for Society.”</span>
<em>Energy Policy</em> 39 (10): 5938–52.
</div>
<div id="ref-ma2019lowincome" class="csl-entry">
Ma, Ou, Jonathan Layke, Jeff Deason, Richard E Brown, and Alex Lekov.
2019. <span>“Low-Income Energy Affordability Data (LEAD) Tool
Methodology.”</span> LBNL-2001326. Lawrence Berkeley National
Laboratory.
</div>
<div id="ref-ross2018high" class="csl-entry">
Ross, Lauren, Ariel Drehobl, and Brian Stickles. 2018. <span>“How Energy
Efficiency Cuts Costs for Low-Income and Minority Households.”</span>
<em>American Council for an Energy-Efficient Economy</em>.
</div>
<div id="ref-scheier2022measurement" class="csl-entry">
Scheier, Eric, and Noah Kittner. 2022. <span>“A Measurement Strategy to
Address Disparities Across Household Energy Burdens.”</span> <em>Nature
Communications</em> 13 (1): 1717. <a href="https://doi.org/10.1038/s41467-021-27673-y" class="external-link">https://doi.org/10.1038/s41467-021-27673-y</a>.
</div>
<div id="ref-sigrinRooftopSolarTechnical2018" class="csl-entry">
Sigrin, Benjamin, and Meghan Mooney. 2018. <span>“The Rooftop Solar
Technical Potential of Low-to-Moderate Income Households in the United
States (REPLICA).”</span> NREL/TP-6A20-70901. National Renewable Energy
Laboratory.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric Scheier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
